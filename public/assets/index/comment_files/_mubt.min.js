/**
 * Copyright(C) 2008 - 2018, Ctrip.com All rights reserved. 
 * Date: 2018/03/09
 */
!function(){"use strict";var t=window;if(!t.JSON||!t.JSON.parse||!t.JSON.stringify||"undefined"==typeof localStorage||t.$_bf&&!0===t.$_bf.loaded)return;var d="charCodeAt";function e(t,e){var r,n,i,a,o,s,c,u;for(r=3&t.length,n=t.length-r,i=e||31,o=3432918353,s=461845907,u=0;u<n;)c=255&t[d](u)|(255&t[d](++u))<<8|(255&t[d](++u))<<16|(255&t[d](++u))<<24,++u,i=27492+(65535&(a=5*(65535&(i=(i^=c=(65535&(c=(c=(65535&c)*o+(((c>>>16)*o&65535)<<16)&4294967295)<<15|c>>>17))*s+(((c>>>16)*s&65535)<<16)&4294967295)<<13|i>>>19))+((5*(i>>>16)&65535)<<16)&4294967295))+((58964+(a>>>16)&65535)<<16);switch(c=0,r){case 3:c^=(255&t[d](u+2))<<16;case 2:c^=(255&t[d](u+1))<<8;case 1:i^=c=(65535&(c=(c=(65535&(c^=255&t[d](u)))*o+(((c>>>16)*o&65535)<<16)&4294967295)<<15|c>>>17))*s+(((c>>>16)*s&65535)<<16)&4294967295}return i^=t.length,i=2246822507*(65535&(i^=i>>>16))+((2246822507*(i>>>16)&65535)<<16)&4294967295,i=3266489909*(65535&(i^=i>>>13))+((3266489909*(i>>>16)&65535)<<16)&4294967295,(i^=i>>>16)>>>0}function c(t,e){var r=65535&t,n=65535&e;return(((t>>16&65535)*n+r*(e>>16&65535)&65535)<<16>>>0)+r*n}function s(t){var e,r,n=t.length,i=n%4,a=n-i,o=1540483477;e=0^n;for(var s=0;s<a;)r=t[d](s++),r|=t[d](s++)<<8,r|=t[d](s++)<<16,r=c(r=((r=c(r|=t[d](s++)<<24,o))^r>>>24)>>>0,o),e=((e=c(e,o))^r)>>>0;switch(i){case 3:e=(e^t[d](s+2)<<16)>>>0;case 2:e=(e^t[d](s+1)<<8)>>>0;case 1:e=c(e^=t[d](s),o)}return e=((e=c(e=(e^e>>>13)>>>0,o))^e>>>15)>>>0}var l=window,u=l.document,f=l.navigator,n=f.userAgent,p=u.location,h="performance",r=-1!=n.indexOf("CtripWireless");function o(t){return u.getElementById(t)}function g(t){var e=o(t);return e&&e.value||""}function v(){return f.language||f.userLanguage||f.browserLanguage||""}function i(){return(new Date).getTimezoneOffset()}function a(){var t=l.screen||{},e="";return t&&(e+=t.width+"x"+t.height+"|"+t.colorDepth,t.deviceYDPI&&(e+="|DPI"+t.deviceXDPI+"x"+t.deviceYDPI)),{w:t.width||0,h:t.height||0,c:t.colorDepth,fp:e}}function m(){var t=u.createElement("canvas");if(void 0===t.getContext)return"";t.width=600,t.height=30,t.style.border="1px solid #3a3a3a";var e=t.getContext("2d"),r=e.createLinearGradient(0,0,200,0);return r.addColorStop(0,"rgb(200,0,0)"),r.addColorStop(.5,"rgb(0,200,0)"),r.addColorStop(1,"rgb(200,0,0)"),e.fillStyle=r,e.fillRect(0,0,200,30),e.fillStyle="#360",e.font="13px _sans",e.textBaseLine="top",e.fillText("English中文Հայերենا繁體輸入لعربيةҚазақша`~1!2@3#4$5%6^7&8*9(0)-_=+[{]}|;:',<.>/?",5,18),e.beginPath(),e.strokeStyle="blue",e.lineWidth=5,e.shadowOffsetX=2,e.shadowOffsetY=2,e.shadowColor="rgb(85,85,85)",e.shadowBlur=3,e.arc(500,15,10,0,2*Math.PI,!0),e.stroke(),e.closePath(),t.toDataURL()+function(){var t=u.createElement("canvas");{if(void 0===t.getContext)return"";var e=null,r=["webgl","experimental-webgl","moz-webgl","webkit-3d"];try{for(var n=0;n<r.length&&null===e&&!(e=t.getContext(r[n],{width:600,height:300}));n++);return e.getParameter(e.RENDERER)+","+e.getParameter(e.VERSION)}catch(t){}}return""}()}var _="4.0.0",b=+new Date,y=function(){},k=Object.prototype.toString,S=Object.prototype.hasOwnProperty;function w(t){return!isNaN(parseFloat(t))}function T(t){return"string"==typeof t}function E(t){return"[object Function]"==k.call(t)}function C(t){return"[object Array]"==k.call(t)}function I(t){return"[object Object]"==k.call(t)}function O(t){var e=parseFloat(t);return isNaN(e)?0:e}function x(t){if(Object.keys)return Object.keys(t);var e=[];for(var r in t)t.hasOwnProperty(r)&&e.push(r);return e}function N(){return(new Date).getTime()}function D(t){var e=typeof t;return t&&(T(e)||"number"==e||"boolean"==e)}function L(t){return encodeURIComponent(t||"")}function P(t){return decodeURIComponent(t||"")}function A(){var t,e,r,n=arguments[0]||{},i=1,a=arguments.length;for(a===i&&(n=this,--i);i<a;i++)if(null!=(r=arguments[i]))for(e in r)if(S.call(r,e)){if(n===(t=r[e]))continue;void 0!==t&&(n[e]=t)}return n}var U=/d{1,4}|m{1,2}|yy(?:yy)?/g;function R(t,e){for(t=String(t),e=e||2;t.length<e;)t="0"+t;return t}var j=/^(?:([^:\/?#]+):)?(?:\/\/()(?:(?:()(?:([^:@]*):?([^:@]*))?@)?([^:\/?#]*)(?::(\d*))?))?()(?:(()(?:(?:[^?#\/]*\/)*)()(?:[^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,B=["source","scheme","authority","userInfo","user","pass","host","port","relative","path","directory","file","query","fragment"];function M(t){if("string"!=typeof t)return"";for(var e=j.exec(t),r={},n=14;n--;)e[n]&&(r[B[n]]=e[n]);return r}function F(t){var e,r={},n=t.split("&");if(n&&n.length)for(var i=0,a=n.length;i<a;i++)1<(e=n[i].split("=")).length&&(r[e[0]]=e[1]);return r}function z(t){try{return JSON.parse(t)}catch(t){}}var H=[];function J(t){H[t]=!0}function Y(t,e,r){var n=new RegExp("(^| )"+t+"=([^;]*)(;|$)"),i=u.cookie.match(n);return i&&1<i.length?r?P(i[2]):i[2]:e||""}var q=function(){if(l.Storage&&l.localStorage){try{localStorage.setItem("__store__test","1"),localStorage.getItem("__store__test"),localStorage.removeItem("__store__test")}catch(t){return J(19),!1}return!0}return J(18),!1}();function V(t){return q&&localStorage.getItem(t)||""}for(var X,G,W,$="https:"!=p.protocol&&"http:"!=p.protocol,K=p.hostname,Q=""!=V("isPreProduction"),Z={fp:(W=[],W.push(e((X=[],G=a(),l.maxConnectionsPerServer&&X.push("maxcon"+(window.maxConnectionsPerServer||"0")),f.hardwareConcurrency&&X.push("hdcon"+f.hardwareConcurrency),X.push("zone"+i()),X.push(G.fp),X.join(""))).toString(36)),W.push(e(function(){var t=[];if(f.mimeTypes){for(var e=f.mimeTypes,r=e.length||0,n="",i=0;i<r;i++){var a=e[i];n+=a.type+a.suffixes+a.description}t.push(n)}if(f.plugins){for(var o=f.plugins,s="pls",c=0;c<o.length;c++){var u=o[c];if(s+=u.filename||u.name||c,30<c)break}t.push(s)}return t.push(f.userAgent),t.push(v()),t.push(f.doNotTrack||"0"),t.push(f.platform||"None"),t.join("")}()).toString(36)),W.push(e(m()).toString(36)),W.join("-")),domain:function(){var t,e,r="_bfp=cookie",n=p.hostname.split(".");for(t=n.length-1;0<=t;t--)if(e="."+n.slice(t).join("."),u.cookie=r+";domain="+e+";",-1<u.cookie.indexOf(r))return u.cookie=r.split("=")[0]+"=;domain="+e+";expires=Thu, 01 Jan 1970 00:00:01 GMT;",e}(),env:r||$?"hybrid":"h5",protocol:$?"https:":"",surl:Q||/((test[a-z]?|dev|uat|ui|local)\.sh\.(ctrip|huixuan)travel)|(qa\.nt\.ctripcorp)/i.test(K)||"127.0.0.1"==K?"//s.uat.qa.nt.ctripcorp.com/bf.gif":"//s.c-ctrip.com/bf.gif",delay:0,debug:!1,rms:!0,markting:!0,isfile:$,tcp:0,readyWait:61},tt=16384,et=3,rt=130,nt=1023,it="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",at=[],ot=0;ot<64;ot++)at[it.charCodeAt(ot)]=ot;function st(t){if(!t)return"";for(var e=[],r=0,n=(t=unescape(encodeURIComponent(t))).length;r<n;r++)e[r]=t.charCodeAt(r);return function(s){var c=[],u=[],d=-1,f=0,l=0,r=0,n=0,e=[];_(19);for(var p=0;p<s.length&&l<s.length;p+=tt)0<p&&(u=u.slice(tt)),t();return-1!=d&&m(),2==n?(i(r<<4&63),65==it.length&&(i(64),i(64))):4==n&&(i(r<<2&63),65==it.length&&i(64)),e.join("");function t(){for(var t=h(p+2*tt,s.length),e=h(t,s.length-et+1);l<t;l++){var r=0,n=0;if(l<e){var i=g();if(f<=l)for(var a=c[i]-1;r!=rt&&0<=a&&l-tt<=a;){var o=v(a);et<=o&&r<o&&(n=l-a-(r=o)),a=u[a-p]}u[l-p]=c[i]-1,c[i]=l+1}if(et<=r){for(f=l+r,-1!=d&&(m(),d=-1),_(r-et);127<n;)_(255&(127&n|128)),n>>=7;_(n)}else f<=l&&-1==d&&(d=l)}}function h(t,e){return Math.min(t,e)}function g(){for(var t=0,e=l;e<l+et;e++)t*=16777619,t^=s[e];return t&nt}function v(t){var e,r,n=h(t+rt,l);for(e=t,r=l;e<n&&r<s.length&&s[e]==s[r];e++,r++);return e-t}function m(){for(var t=d;t<l;t+=127){var e=h(127,l-t);_(255&-e);for(var r=t;r<l&&r<t+e;r++)_(s[r])}}function _(t){var e=r<<6-n;i(63&(e|=(r=255&t)>>(n+=2))),6<=n&&i(63&(e=r>>(n-=6)))}function i(t){e.push(it.charAt(t))}}(e)}function ct(t,e){var r=new Image;r.width=r.height=1,r.onload=r.onerror=function(){r.onload=r.onerror=null,e(1)},r.src="https:"+Z.surl+"?"+t+"&_mt="+N().toString(36)+(1*(""+Math.random()).slice(-8)).toString(32)}function ut(t){var e=E(t.f)?t.f:y;Z.debug;try{(Z.tcp||r)&&"undefined"!=typeof CtripBusiness&&E(CtripBusiness.app_track_UBT_JS_log)?function(t,e){t.c[9]=n;var r={c:t.c,dataType:t.t,priority:t.p||6};switch(t.t){case"uinfo":case"error":case"ub":case"ps":case"t":case"useraction":case"matrix":r.d=t.d;break;default:return}r.d?(CtripBusiness.app_track_UBT_JS_log("ubt_js_sdk",r),e(1)):e(0)}(t,e):function(t,e){var r,n;switch(t.t){case"t":var i=t.d;r="ac=tl&pi="+t.c[0]+"&key="+i.key+"&val="+L(i.val)+"&pv="+t.c[1]+"."+t.c[2]+"."+t.c[3]+"&duid="+i.duid+"&v=6&env="+i.env+"&c="+i.clientid;break;case"uinfo":case"error":case"ub":case"ps":(n={c:t.c,d:{}}).d[t.t]=t.d,r="ac=g&d="+L(JSON.stringify(n))+"&v="+_;break;case"useraction":case"matrix":n=[[1,t.t],t.c,t.d],r="ac=a&d="+st(JSON.stringify(n))+"&c=1&v="+_;break;case"restiming":n=[[1,"ctrip"],{pid:t.c[0],vid:t.c[1],sid:t.c[2],pvid:t.c[3],ver:_,ifr:0},[[["ubt",t.t,1],t.d]]],r="a=z&d="+st(JSON.stringify(n))}r?ct(r+"&t="+N(),e):e(4,t.t+" not support!")}(t,e)}catch(t){e(0,t&&t.message||""),J(5)}}function dt(){this.k=[],this.v={}}dt.prototype.get=function(t){return this.v.hasOwnProperty(":"+t)?this.v[":"+t]:""},dt.prototype.set=function(t,e){this.k.push(t),this.v[":"+t]=e},dt.prototype.map=function(t){for(var e=0,r=this.k.length;e<r;e++){var n=this.k[e],i=this.get(n);i&&t(i,n)}};var ft=new dt,lt="CTRIP_UBT_M";function pt(){this.ppi=0,this.ppv=0,this.isnewvid=0,this.isnewsid=0,this.init()}var ht=pt.prototype;ht.init=function(){var t=z(V(lt))||{},e=function(t){var e={ts:0};if(t){var r=t.split(".");r&&6<r.length&&(e.pid=r[8]||0,e.vid=r[1]+"."+r[2],e.sid=O(r[6]),e.pvid=O(r[7]),e.ts=O(r[5]),e.create=O(r[4]))}return e}(Y("_bfa","",!0));!function(t){if("string"!=typeof t)return;var e=p.hostname,r=e.substring(0,e.indexOf(t));if(r)for(var n=r.split("."),i=n.length-1;0<i;i--)t="."+n[i]+t,u.cookie="_bfa=;domain="+t+";path=/;expires=Thu, 01 Jan 1970 00:00:01 GMT;"}(Z.domain);var r,n,i,a=e.vid||t.vid,o=e.ts||t.ts||t.sid_ts;a&&o?(3e5<(r=Math.max(e.sid||0,t.sid||0))&&(r=0),3e5<(n=Math.max(e.pvid||0,t.pvid||0))&&(n=0),!r||18e5<+new Date-o?(r+=1,this.isnewsid=0):(this.ppi=t.pid||e.pid||0,this.ppv=n),this.vid=a,this.sid=r,this.pvid=n+1,this.create=e.create||t.create):(this.vid=b+"."+(i=l.screen,s([f.appName||"",f.appVersion||"",f.platform||"",f.userAgent,i.width+"x"+i.height,i.colorDepth,u.cookie||""].join("")).toString(36)),this.sid=1,this.pvid=1,this.isnewvid=1,this.isnewsid=1,this.create=b),this.update(this.ppi)},ht.update=function(t){var e,r,n=N(),i="1."+this.vid+".1."+this.create+"."+n+"."+this.sid+"."+this.pvid+"."+t,a={pid:t,vid:this.vid,sid:this.sid,sid_ts:n,pvid:this.pvid,ts:n,create:this.create};!function(t,e,r,n,i){i=i||"/";var a=";domain="+n,o="";0<r&&(o=";expires="+new Date(N()+r).toUTCString()),u.cookie=t+"="+L(e)+a+";path="+i+o}("_bfa",i,63072e6,Z.domain),e=lt,r=JSON.stringify(a),q&&localStorage.setItem(e,r)};var gt,vt,mt,_t,bt=/\$\{(\w+)\}/g,yt="",kt={useraction:[],matrix:[]};try{mt=u.location,_t=a(),ft.set("url",mt.href),ft.set("refer",function(){var t="";try{t=u.referrer}catch(t){}if(!t&&l.opener)try{t=l.opener.location.href}catch(t){}return t}()),ft.set("screen:width",_t.w),ft.set("screen:height",_t.h),vt="RID-"+s(p.pathname+p.search),ft.set("rid",Y(vt)),gt="","object"==typeof Lizard&&Lizard.selfCollection&&(gt=Lizard.selfCollection||Lizard.version||""),ft.set("other",JSON.stringify({lizard:gt,rg:Y("_RSG",""),lang:u.documentElement.getAttribute("lang")||""})),function(){var t=Y("Session");if(t){var e=F(t);ft.set("search:engine",e.SmartLinkCode),ft.set("search:keyword",e.SmartLinkQuary)}}()}catch(t){J(3)}function St(t,e){St.count++,this._store_=[],this._fn_=[],this.pid=-4,this.done=!1,this.meta=new pt,this.h=s(this.meta.vid)%100,this.id=this.meta.pvid,this.orderid="",this.url="",this.refer="",ft.set("user:login",0),this.init(t,e)}St.count=0;var wt=St.prototype;wt.init=function(t,e){if("object"==typeof t)for(var r in t)if(t.hasOwnProperty(r)){var n=t[r],i=typeof n;"string"!=i&&"number"!=i||this.set(r,n)}E(e)&&this._fn_.push(e),this.checkSend()},wt.set=function(t,e){switch(t){case"page_id":this.setPid(e);break;case"orderid":this.orderid=e;break;case"duid":ft.set("user:duid",e),ft.set("user:login",1);break;case"loginName":ft.set("user:id",e),ft.set("user:login",1);break;case"url":case"refer":this[t]=(""+e).substring(0,500);break;default:D(e)?ft.set(t,T(e)?e.substring(0,50):e):J(10)}return 1},wt.setPid=function(t){this.pid=O(t)},wt.getCommon=function(){var t=this.meta;return[this.pid,t.vid,t.sid,t.pvid,ft.get("tid"),ft.get("abtest"),ft.get("mid"),_,Z.fp,"",ft.get("appid")]},wt.getMeta=function(){var t=this.meta;return{pid:this.pid,vid:t.vid,sid:t.sid,pvid:t.pvid,abtest:ft.get("abtest"),pv:this.done}},wt.getUinfo=function(){var t=this.meta,e="";try{e+="cl="+document.cookie.length,e+=",ckl="+(document.cookie.match(/[^=]+=[^;]*;?/g)||[]).length,e+=",lk="+localStorage.length,e+=",log="+function(){for(var t=[],e=0,r=H.length;e<r;e++)H[e]&&(t[Math.floor(e/6)]^=1<<e%6);for(e=0;e<t.length;e++)t[e]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".charAt(t[e]||0);return t.join("")+"~"}()}catch(t){J(9)}var r=new Array(36);return r[0]=14,r[1]=t.ppi,r[2]=t.ppv,r[3]=this.url,r[4]=ft.get("screen:width"),r[5]=ft.get("screen:height"),r[6]=e,r[7]=v(),r[8]=ft.get("search:engine"),r[9]=ft.get("search:keyword"),r[10]=this.refer,r[11]=ft.get("abtest"),r[12]=t.isnewvid,r[13]=ft.get("user:login"),r[14]=ft.get("user:id"),r[15]=ft.get("user:grade"),r[16]=ft.get("user:corp_id"),r[17]=ft.get("product:startcity"),r[18]=ft.get("alliance:id"),r[19]=ft.get("alliance:sid"),r[20]=ft.get("alliance:ouid"),r[21]=this.orderid,r[22]=ft.get("user:duid"),r[23]=ft.get("zdata"),r[24]=ft.get("callid"),r[25]=ft.get("bid"),r[26]=ft.get("clientid"),r[27]=ft.get("sourceid"),r[28]=ft.get("appinfo"),r[29]=Z.env,r[30]=l.devicePixelRatio?1*l.devicePixelRatio:1,r[31]=t.isnewsid,r[32]=ft.get("other"),r[33]=ft.get("product:id"),r[34]=ft.get("traffic:source"),r[35]=ft.get("rid"),r[36]=ft.get("buData"),r},wt.sampled=function(t,e){return e||(e=t,t=0),this.h>=t&&this.h<e},wt.ready=function(t){E(t)&&(this.done?t(1,this):this._fn_.push(t))},wt.co=function(){this.refer||(1<St.count&&""!=yt?(this.refer=yt,J(7)):this.refer=ft.get("refer")),this.url?J(6):this.url=ft.get("url");try{this.orderid?J(11):this.orderid=(i="",(a=z(V("PAYMENT2_ORDER_DETAIL")))&&a.value&&(i=a.value.oid,J(13)),i||(i=g("bf_ubt_orderid"),J(12)),i),ft.get("user:login")?J(8):function(){var r,n,t="",e=Y("login_uid"),i=Y("DUID"),a=Y("CtripUserInfo");if(i&&(-1!=i.indexOf("v=")?(i.replace(/v=(\d+)/,function(t,e){n=e}).replace(/u=([^&]+)/,function(t,e){r=e}),i="bbz_"+n+":"+r):i="online:"+i),a&&(a=F(a),i=i||a.U,t=a.VipGrade),!i&&!e&&(a=z(V("USER")))&&a.value){var o=a.value;e=o.LoginName||o.UserName,t=o.VipGrade,i=o.UserID}e&&ft.set("user:id",e),i&&ft.set("user:duid",i),ft.set("user:grade",t),ft.set("user:corp_id",Y("corpid")),(e||i)&&ft.set("user:login",1)}(),ft.set("abtest",function(){for(var t=o("ab_testing_tracker"),e=[],r="";t;)r+=t.value,e.push(t),t.removeAttribute("id"),t.removeAttribute("name"),t=o("ab_testing_tracker"),r&&";"!=r[r.length-1]&&(r+=";");for(var n=0;n<e.length;n++)e[n].setAttribute("id","ab_testing_tracker");var i=p.hash;return i&&-1!==i.indexOf("abtest=")&&(r+=P(i.replace(/.*(abtest=)/i,"").replace(/#.*/i,""))),280<r.length?(J(14),r.substring(0,280)):r}()),function(){var t=g("bf_ubt_product");t&&ft.set("product:id",t.substring(0,30));var e=Y("StartCity_Pkg");if(e){var r=F(e);ft.set("product:startcity",r.PkgStartCity)}}(),n=Y("Union"),(r=n?F(n):z(n=V("UNION"))||{})&&(ft.set("alliance:id",r.AllianceID||r.ALLIANCEID||""),ft.set("alliance:sid",r.SID||""),ft.set("alliance:ouid",r.OUID||"")),t="",(e=z(V("CINFO")))&&e.version&&(t=JSON.stringify({version:e.internalVersion||"",ver:e.version,net:e.networkStatus||"None",platform:e.platform||""})),ft.set("clientid",V("GUID")),ft.set("sourceid",V("SOURCEID")),ft.set("appinfo",t)}catch(t){J(4)}var t,e,r,n,i,a},wt.checkSend=function(){if(!(this.done||this.pid<-1)){this.done=!0,Z.readyWait=0,this.co();var s=this;ut({t:"uinfo",c:this.getCommon(),d:this.getUinfo(),p:10,f:function(t){if(s.meta.update(s.pid),1==t){for(var e=s._store_,r=0,n=e.length;r<n;r++){var i=e[r];i.c||(i.c=s.getCommon()),"useraction"==i.t||"matrix"==i.t?s._q(i.t,i):("t"==i.t&&(i.d=s._tl(i.d)),ut(i))}setInterval(function(){s._qsend("useraction",!0),s._qsend("matrix",!0)},2e3);for(var a=0,o=s._fn_.length;a<o;a++)s._fn_[a](1,s);yt=s.url}}})}},wt._q=function(t,e){kt[t]&&kt[t].push(e),this._qsend(t)},wt._qsend=function(t,e){var r=kt[t],n=r.length;if(e&&0<n||4<n){for(var i,a=[],o=[],s=0;s<n;s++)i=r[s],a.push(i.d),i.f&&o.push(i.f);ut({t:i.t,c:i.c,p:6,d:a,f:function(t){for(var e=0;e<o.length;e++)o[e](t)}}),kt[t].splice(0,n)}},wt._tl=function(t){var r={duid:ft.get("user:duid"),page_id:this.pid,is_login:ft.get("user:login")};return t.duid=r.duid,t.clientid=ft.get("clientid"),t.env=Z.env,t.val=t.val.replace(bt,function(t,e){return e in r?r[e]:t}),t},wt.send=function(t,e,r){E(r)||(r=y);var n={t:t,d:e,p:6,f:r};if("error"==n.t||this.done){if(n.c=this.getCommon(),"useraction"==n.t||"matrix"==n.t){if("matrix"==n.t&&T(n.d.name)&&-1!=n.d.name.indexOf("JS.Lizard"))return this._q(n.t,n);n.d=[e]}"t"==n.t&&(n.d=this._tl(n.d)),ut(n)}else this._store_.push(n)};var Tt=new St;function Et(t,e){Tt.done?Tt=new St(t,e):Tt.init(t,e)}function Ct(e){e=e||{};var r=!1,t=u.createElement("script");t.type="text/javascript",t.onload=t.onreadystatechange=function(t){r||this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState||(this.onload=this.onreadystatechange=null,r=!0,e.onload&&e.onload(t))},t.src=e.url+(e.mask?"?="+function(t){t=t||"yyyymmdd";var e=new Date,r=e.getFullYear(),n=e.getMonth(),i=e.getDate(),a={d:i,dd:R(i,2),m:n+1,mm:R(n+1),yy:e.getYear(),yyyy:r};return t.replace(U,function(t){return a[t]||t})}(e.mask):"");var n=u.getElementsByTagName("script")[0];n.parentNode.insertBefore(t,n)}function It(t){Ct({mask:"yyyymmdd",url:"https://webresource.c-ctrip.com/ResUnionOnline/R7/common/h5Redirect.js",onload:t})}var Ot=1;function xt(t){return t&&(T(t)||w(t))}function Nt(t,e){return T(t)&&t.substring(0,e)||""}var Dt={},Lt={_config:function(t,e,r){if(I(t)){for(var n=x(t),i=0;i<n.length;i++){var a=n[i];Z[a]=t[a]}r=e}else Z[t]=e;Z.debug&&(Z.surl="//s.uat.qa.nt.ctripcorp.com/bf.gif"),r&&r()},_set:function(t,e,r){var n="Value Error";D(e)&&(n=Tt.set(t,e)),r&&r(n)},_getFullPV:function(t){var e=Tt.getMeta(),r=e.vid+"."+e.sid+"."+e.pvid;return t&&t(r)||r},_getStatus:function(t){var e=Tt.getMeta();return t&&t(e)||e},_getFP:function(t,e){return t&&t(e?"":Z.fp)},_getPageid:function(r){Tt.done?r(!1,Tt.pid):Tt.ready(function(t,e){r(!1,e.pid)})},_unload:function(t){if("object"!=typeof Lizard||1!=Ot){if("object"==typeof CtripBusiness&&E(CtripBusiness.app_send_ubt_log)){var e=Tt.getMeta();CtripBusiness.app_send_ubt_log({page:e.pid,vid:e.vid,sid:e.sid,pvid:e.pvid,ts:+new Date})}Et(t)}else Ot=0},_asynRefresh:function(t,e){if(t&&t.buData){for(var r=x(t.buData),n=r.length,i=n<3,a=0;a<n;a++){var o=t.buData[r[a]];("string"!=typeof o||30<o.length)&&(i=!1)}i&&ft.set("buData",t.buData)}Et(t,e)},_tracklog:function(t,e,r){xt(t)&&D(e)?Tt.send("t",{key:t,val:e,v:6},r):r&&r(0)},_trackError:function(t,e){if("object"!=typeof t)return e(0);for(var r=["version","message","line","file","category","framework","time","repeat","islogin","name","column"],n=[7,"",0,"","","",N()-b,1,ft.get("user:login"),"",0],i=1,a=r.length;i<a;i++){var o=r[i];if(t[o]){var s=t[o]+"";switch(o){case"message":case"file":s=Nt(s,500);break;case"category":case"framework":case"name":s=Nt(s,100);break;default:s=O(s)}n[i]=s}}t.stack?C(t.stack)?n.push(t.stack.join("").slice(-1600)):n.push(String(t.stack).slice(-1600)):n.push(""),Tt.send("error",n,e)},_trackUserBlock:function(t,e){if("object"!=typeof t)return e(0,"erro");var r=[];r[0]=6,r[1]=ft.get("user:login"),r[2]=Nt(t.message,300),r[3]=Nt(t.value,300),r[4]=Nt(t.type,50),r[5]=Nt(t.dom,100),r[6]=Nt(t.form,100),r[7]=O(t.count),Tt.send("ub",r,e)},_trackMetric:function(t,e){if(!t||"object"!=typeof t)return"Error Param";e=e||Tt;var r=A({name:"",tag:{},value:0,ts:N(),callback:y,timeout:!1,sample:100},t),n=function(t){if(!t)return 1;var e=x(t),r=e.length;if(8<r)return 8;for(var n=0;n<r;n++){var i=t[e[n]];switch(typeof i){case"string":t[e[n]]=Nt(i,300);break;case"number":case"boolean":break;default:return 110}}return 1}(r.tag);if(!xt(r.name)||1!=n||!function(t){if(w(t))return!0;if(I(t)){var e=x(t),r=e.length;if(30<r)return!1;for(var n=0;n<r;n++)if(!xt(e[n])||!w(t[e[n]]))return!1;return!0}return!1}(r.value))return r.callback(n);e.send("matrix",{name:r.name,tags:r.tag,value:r.value,ts:r.ts},r.callback),r.timeout&&setTimeout(function(){r.callback(n)},r.timeout||50)},_trackMatrix:function(t,e,r,n,i){this._trackMetric({name:t,tag:e,value:r,ts:n,callback:i})},_time:function(t,e){Dt[t+""]={value:N(),opt:e||{},pv:Tt}},_timeEnd:function(t,e){var r=Dt[t+""];if(r&&r.value){var n=N()-r.value,i=A(r.opt,e||{});if(i.name)return i.value=n,this._trackMetric(i,r.pv),delete Dt[t],n}},_require:function(t,e){"markting"==t&&It(e)}},Pt=[],At=!1;function Ut(t){for(var e=0;e<Pt.length;e++)Pt[e](t)}!function t(){var e,r=(e=g("page_id"))&&e.replace(/^\s+|\s+$/,"");"wait"==r?J(1):r&&"0"!=r?(At=!0,Ut(r)):"complete"==u.readyState&&(At=!0,Ut(0)),!At&&0<--Z.readyWait&&setTimeout(t,500)}();var Rt,jt=u.documentElement,Bt=u.body,Mt=!1,Ft=!1;function zt(t,e){var r=0;if("DIV"==e&&(t.attributes["page-url"]||t.getAttribute("page-url")))return"";if(t.parentNode)for(var n=t.parentNode.firstChild;n&&n!=t;)1==n.nodeType&&n.tagName==t.tagName&&r++,n=n.nextSibling;return 0<r?"["+ ++r+"]":""}function Ht(t){if(t&&t.target){var e=t.target;if(e&&1==e.nodeType&&e.nodeName&&e.getBoundingClientRect){var r,n,i=e.nodeName.toUpperCase(),a=e.getBoundingClientRect(),o="",s=Math.max(jt.scrollLeft,Bt.scrollLeft),c=Math.max(jt.scrollTop,Bt.scrollTop),u=Rt.pageX||t.pageX||0,d=Rt.pageY||t.pageY||0,f=parseInt((jt.clientWidth||Bt.clientWidth)/2,10);if("SELECT"==i&&d-a.top-c<0?(o+="[@x='"+parseInt(u+a.left+s-f,10)+"'][@y='"+parseInt(d+a.top,10)+"']",r=u,n=d-c):(o+="[@x='"+(u-f)+"'][@y='"+d+"']",r=parseInt(u-a.left-s,10)||0,n=parseInt(d-a.top-c,10)||0),0<=r&&0<=n&&r<=screen.width+s){o+="[@rx='"+r+"']",o+="[@ry='"+n+"']";var l=function(t){for(var e,r=[],n=0;t&&9!=t.nodeType;){if(1==t.nodeType){var i=(t.nodeName||"").toUpperCase(),a=t.id||"",o=i+zt(t,i);a&&-1==a.indexOf("client_id_viewport")&&(o+="[@id='"+a+"']"),(e=t.getAttribute("data-ubt-key"))&&(o+="[@cid='"+e+"']"),r[n++]=o}t=t.parentNode}return 2<r.length?r.reverse().join("/"):""}(e);l&&Tt.send("useraction",{action:"click",xpath:l+o,ts:+new Date})}}}}function Jt(){return f.connection&&f.connection.type||"unknown"}var Yt=/^(file|chrome|asset)|\.(baidu|ctrip|google|bdimg|xiecheng|amap|tieyou|c-ctrip|ctripcorp|hhtravel)\./;var qt,Vt,Xt,Gt,Wt,$t,Kt=[{bu:"HTL",rg:/^(P_HOTEL|U_HOTEL|P_SEARCH|S_HOTEL|F_HOTEL|BNB|SALE_HOTEL).*/i},{bu:"FLT",rg:/^(FLIGHT|FLTMX|FLT_|AllAir).*/i},{bu:"TRN",rg:/^(TRAIN|TRAININFO|DISTRIBUTE|BOOKINFO).*/i},{bu:"BUS",rg:/^(P_CARCH|BUS_|SHIPLINE|YUECHE|TOUR_BUS).*/i},{bu:"TOUR",rg:/^(TOUR|VACATION|AROUND|U_ACTIVITY_DAYTOUR|DIYFHX|DIYFHXSDP|VTM|TOURVTM|TUAN_).*/i},{bu:"TTD",rg:/^(P_TICKET|U_TICKET|TTD_).*/i},{bu:"FNC",rg:/^(F_LIPIN|F_FX).*/i},{bu:"TLS",rg:/^(P_SHOPPING).*/i},{bu:"LT",rg:/^(S_HHTravel).*/i},{bu:"MKT",rg:/^(UNION|SiteType|SiteID|BidAdCount|DyAdIndex|AdData|DyAd).*/i},{bu:"CAR",rg:/^(CAR_).*/i},{bu:"CRU",rg:/^(CRUISE_).*/i},{bu:"BMAP",rg:/^(BMap).*/i}];function Qt(t){if(!t)return 0;var e,r,n=0;for(e=0,r=(t+="").length;e<r;e++)n+=t.charCodeAt(e)<=65535?2:4;return n}function Zt(){for(var t,e=[],r=/^([a-z]+\d*|webresource\.english)\.((c-)?c?trip.com)/i,n=l[h].getEntriesByType("resource"),i=n.length,a=0;a<i;a++){var o=n[a],s=M(o.name);if("string"==typeof s.host&&r.test(s.host)&&!(0==(t=o).connectStart||t.connectEnd-t.connectStart<6||t.responseEnd-t.responseStart<6||t.domainLookupStart==t.domainLookupEnd&&t.domainLookupEnd==t.fetchStart&&t.fetchStart==t.connectStart&&t.fetchStart==t.connectEnd)){for(var c=["entryType","initiatorType","startTime","redirectStart","redirectEnd","fetchStart","domainLookupStart","domainLookupEnd","connectStart","connectEnd","secureConnectionStart","requestStart","responseStart","responseEnd","transferSize","encodedBodySize","decodedBodySize"],u={name:o.name,nextHopProtocol:""},d=0,f=c.length;d<f;d++)u[c[d]]=o[c[d]]||0;if(e.push(u),2<e.length)break}}return e}function te(){for(var t,e=arguments,r=0,n=0,i=e.length;r<i;r++){var a=e[r];C(a)?(t=a[0],Lt[t]&&Lt[t].apply(Lt,Array.prototype.slice.call(a,1))):n++}return n}if(C(l.__bfi))for(var ee=0,re=l.__bfi.length;ee<re;ee++)te(l.__bfi[ee]);else l.__bfi=[];l.__bfi.push=te,l.$_bf=A(l.$_bf||{},{version:_,loaded:!0,_getFullPV:Lt._getFullPV,_getStatus:Lt._getStatus,tracklog:Lt._tracklog,trackError:Lt._trackError,asynRefresh:Et}),function(e){if(!l[h]||!l[h].timing)return;var r=0;(function t(){l[h].timing.loadEventEnd?e.send("ps",function(){for(var t=["navigationStart","redirectStart","unloadEventStart","unloadEventEnd","redirectEnd","fetchStart","domainLookupStart","domainLookupEnd","connectStart","connectEnd","requestStart","responseStart","responseEnd","domLoading","domInteractive","domContentLoadedEventStart","domContentLoadedEventEnd","domComplete","loadEventStart","loadEventEnd"],e=l[h].timing,r=[6],n=0;n<t.length;n++)r.push(e[t[n]]);return r.push(l[h].navigation.type||0),r.push(l[h].navigation.redirectCount||0),r}()):++r<300&&setTimeout(t,1e3)})()}(Tt),Vt=(qt="ontouchstart"in l)?"touchstart":"mousedown",Xt=qt?"touchmove":"mousemove",Gt=qt?"touchend":"mouseup",u.addEventListener(Vt,function(t){Rt=t.touches&&t.touches[0]||t,Ft=!1,Mt=!0},!0),u.addEventListener(Xt,function(t){if(Mt){var e,r,n=t.touches&&t.touches[0]||t;e=Math.abs(n.pageX-Rt.pageX),r=Math.abs(n.pageY-Rt.pageY),Ft=!(e<6||r<6)}},!0),u.addEventListener(Gt,function(t){if(!Ft&&Mt&&Bt&&jt)try{Ht(t)}catch(t){J(15)}Mt=!1,Rt=null},!0),function(){if(null===l.onerror){var a={};window.onerror=function(){try{var t=arguments,e=[];if(t[4]){var r=t[4];"string"==typeof r?e=r.split("\n"):"object"==typeof r&&r.stack&&(e=r.stack.split("\n"))}var n={message:""+t[0],file:""+t[1],category:"inner-error",framework:"normal",time:N()-b,line:t[2],column:t[3],stack:e,repeat:1},i="err_"+s(n.message+n.file+n.line);a[i]||(a[i]=!0,Lt._trackError(n))}catch(t){J(16)}}}}(),Tt.sampled(5)&&function(t){var e=function(){for(var t=[],e=Jt(),r=u.scripts,n=r.length,i=0;i<n;i++){var a=r[i];a.src&&(Yt.test(a.src)||t.push({name:"ubt.hijack",tag:{type:"script",url:a.src,net:e},value:1,ts:N()}))}return t}();if(l.top!==l&&0<l.length&&l.top.location.href){var r=l.top.location.href||"";Yt.test(r)||e.push({name:"ubt.hijack",tag:{type:"iframe",url:r,net:Jt()},value:1,ts:N()})}e.length&&t.send("matrix",e)}(Tt),Tt.sampled(99,100)&&Tt.id%10==5&&function(){var t="",e="_CACHE",r={other:0},n=0,i=l.localStorage;for(var a in i){var o=i[a];if(i.hasOwnProperty(a)&&"function"!=typeof o&&"object"!=typeof o){var s=!1,c=Qt(o)+Qt(a);for(var u in Kt){var d=Kt[u];if(d.rg.test(a)){n+=c,/.*(_cache)$/i.test(a)?r[d.bu+e]?r[d.bu+e]+=c:r[d.bu+e]=c:r[d.bu]?r[d.bu]+=c:r[d.bu]=c,s=!0;break}}s||(n+=c,r.other+=c)}}if(n){for(var f in t="all="+n,r)t+="&"+f+"="+r[f];Lt._tracklog("ubt_m_localstorage",t)}}(),r||!Tt.sampled(10)&&-480==i()||(Wt=Tt,l[h]&&l[h].getEntriesByType&&(l.addEventListener("load",function(){0<Zt().length&&Wt.send("restiming",Zt())}),J(17))),"http:"!=p.protocol&&"https:"!=p.protocol||setTimeout(function(){Z.rms&&Ct({mask:"yyyymmdd",url:"https://webresource.c-ctrip.com/resaresonline/risk/ubtrms/latest/default/mrms.js"});var t=g("bf_ubt_markting_off");Z.markting=(!t||"false"==t)&&Z.markting,Z.markting&&It()},30),$t=function(t){J(2),Tt.setPid(t),Tt.checkSend()},1==At?$t(g("page_id")):Pt.push($t)}();
